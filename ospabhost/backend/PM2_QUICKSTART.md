# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç PM2

## –ó–∞–ø—É—Å–∫ Backend –≤ 4 —ç–∫–∑–µ–º–ø–ª—è—Ä–∞—Ö

### –ß–µ—Ä–µ–∑ npm scripts (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):

```bash
# 1. –°–±–æ—Ä–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
npm run build

# 2. –ó–∞–ø—É—Å–∫ PM2
npm run pm2:start

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
npm run pm2:status
```

### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã:

```bash
# –î–∞—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑)
chmod +x start-pm2.sh restart-pm2.sh stop-pm2.sh

# –ó–∞–ø—É—Å–∫
./start-pm2.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
./restart-pm2.sh

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø–µ—Ä–µ—Å–±–æ—Ä–∫–æ–π
./restart-pm2.sh --build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –∏–∑ Git
./restart-pm2.sh --update

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
./stop-pm2.sh
```

### –ß–µ—Ä–µ–∑ PM2 –Ω–∞–ø—Ä—è–º—É—é:

```bash
# –ó–∞–ø—É—Å–∫
pm2 start ecosystem.config.js --env production

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
pm2 save

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
pm2 startup
# –í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é –≤—ã–≤–µ–¥–µ—Ç pm2 startup
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

–ß—Ç–æ–±—ã backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–ª—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Å–µ—Ä–≤–µ—Ä–∞:

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å
npm run pm2:start

# 2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫
pm2 startup

# 3. –í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É, –∫–æ—Ç–æ—Ä—É—é –≤—ã–≤–µ–¥–µ—Ç pm2 startup
# –ù–∞–ø—Ä–∏–º–µ—Ä:
# sudo env PATH=$PATH:/usr/bin pm2 startup systemd -u root --hp /root

# 4. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
pm2 save
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
npm run pm2:logs

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
npm run pm2:monit

# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
npm run pm2:status

# –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
pm2 show ospab-backend
```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Ä—É—á–Ω—É—é
git pull origin main
npm install
npm run build
npm run pm2:restart

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./restart-pm2.sh --update
```

## üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –ß–µ—Ä–µ–∑ npm
npm run pm2:stop

# –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
./stop-pm2.sh

# –ù–∞–ø—Ä—è–º—É—é
pm2 stop ospab-backend
pm2 delete ospab-backend
pm2 save
```

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
pm2 logs ospab-backend --lines 100

# –û—á–∏—Å—Ç–∫–∞ –ª–æ–≥–æ–≤
pm2 flush

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–µ–∑ –¥–∞—É–Ω—Ç–∞–π–º–∞
pm2 reload ospab-backend

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ PM2
npm install -g pm2@latest
pm2 update

# –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
pm2 save --force
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# 1. –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 4 –∏–Ω—Å—Ç–∞–Ω—Å–∞ "online")
pm2 list

# 2. Backend –¥–æ—Å—Ç—É–ø–µ–Ω
curl http://localhost:5000

# 3. –õ–æ–≥–∏ –±–µ–∑ –æ—à–∏–±–æ–∫
pm2 logs ospab-backend --lines 50
```

## ‚ö†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### PM2 –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é Node.js
node -v

# –ü–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PM2
npm install -g pm2@latest

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
pm2 kill
rm -rf ~/.pm2

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
npm run pm2:start
```

### –ü—Ä–æ—Ü–µ—Å—Å—ã –∫—Ä–∞—à–∞—Ç—Å—è

```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—à–∏–±–∫–∏
pm2 logs ospab-backend --err

# –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –ø–∞–º—è—Ç–∏ –≤ ecosystem.config.js
# max_memory_restart: '1G'

# –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤
# instances: 2
```

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. [PM2_SETUP.md](./PM2_SETUP.md) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.
